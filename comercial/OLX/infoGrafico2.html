<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Salesforce Service Funnel Architecture</title>
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Chart.js -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    
    <!-- Palette Name: Intelligent Cloud Blue (Vibrant & Professional) -->
    <!-- 
        Palette Hex Codes:
        Primary Blue: #0284c7
        Deep Navy: #0f172a
        Vibrant Teal: #0d9488
        Action Orange: #f97316
        Soft Background: #f0f9ff
    -->

    <style>
        /* Custom Chart Container Styles for Responsiveness */
        .chart-container {
            position: relative;
            width: 100%;
            max-width: 600px;
            margin-left: auto;
            margin-right: auto;
            height: 300px; /* Base height */
            max-height: 400px;
        }

        @media (min-width: 768px) {
            .chart-container {
                height: 350px;
            }
        }

        /* Flowchart Custom Styles */
        .flow-box {
            transition: all 0.3s ease;
        }
        .flow-box:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05);
        }
        .arrow-down {
            text-align: center;
            font-size: 24px;
            color: #94a3b8;
            margin: 8px 0;
        }
        .arrow-right {
            display: none;
        }
        @media (min-width: 768px) {
            .arrow-right {
                display: block;
                font-size: 24px;
                color: #94a3b8;
                margin-top: auto;
                margin-bottom: auto;
            }
            .md-arrow-hide {
                display: none;
            }
        }
    </style>
</head>
<body class="bg-slate-50 text-slate-800 font-sans leading-relaxed">

    <!-- Plan Summary
    1. Introduction: Overview of the Service Funnel concept.
    2. Architecture Visualizer: A CSS-based flowchart showing the N0 -> N3 flow.
    3. Performance KPIs: Visualizing the benefits (Deflection, Time Savings).
    4. Level Breakdown: Detailed cards for N0, N1, N2 with specific charts for each logic.
    5. Technical Requirements: List of mandatory Salesforce features.
    -->

    <!-- Chart Selection Justification
    1. Deflection Target (KPI) -> Inform -> Doughnut Chart -> Shows clear proportion of automated vs human.
    2. AHT Reduction (KPI) -> Compare -> Bar Chart -> Before vs After comparison.
    3. N0 Intent Triaging -> Organize -> Horizontal Bar Chart -> Shows distribution of incoming topics handled by GenAI.
    4. N2 Routing Logic -> Relationships -> Pie Chart -> Shows the split between AI Agent and Human Agent.
    -->

    <!-- Explicit Confirmation: NO SVG USED. NO MERMAID JS USED. -->

    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-10">
        
        <!-- Header Section -->
        <header class="text-center mb-16">
            <h1 class="text-4xl md:text-5xl font-extrabold text-[#0f172a] mb-4 tracking-tight">
                Arquitetura de Atendimento <span class="text-[#0284c7]">Inteligente</span> Salesforce
            </h1>
            <p class="text-xl text-slate-600 max-w-3xl mx-auto">
                Uma estrat√©gia de funil ("Service Funnel") desenhada para maximizar a reten√ß√£o digital atrav√©s de IA generativa, garantindo que o toque humano seja reservado para intera√ß√µes complexas e de alto valor.
            </p>
        </header>

        <!-- Section 1: The Funnel Overview (Structured HTML Diagram) -->
        <section class="mb-20">
            <div class="bg-white rounded-2xl shadow-xl p-8 border-t-4 border-[#0284c7]">
                <h2 class="text-2xl font-bold mb-6 text-[#0f172a] border-b pb-2">O Fluxo do Funil de Atendimento</h2>
                <p class="mb-8 text-slate-600">
                    O modelo filtra o volume massivo no topo (N0) e especializa o atendimento na base (N3), preservando o contexto do cliente em cada etapa.
                </p>

                <div class="flex flex-col md:flex-row justify-center items-stretch gap-4 relative">
                    
                    <!-- N0 Node -->
                    <div class="flex-1 flex flex-col items-center">
                        <div class="flow-box bg-blue-50 border-2 border-blue-200 p-6 rounded-xl text-center w-full h-full relative z-10">
                            <div class="text-4xl mb-2">ü§ñ</div>
                            <h3 class="font-bold text-blue-800 text-lg">N√≠vel 0 (N0)</h3>
                            <p class="text-sm font-semibold text-blue-600 mb-2">Reten√ß√£o & Triagem</p>
                            <p class="text-xs text-slate-500">Agentforce+ Knowledge Base</p>
                            <div class="mt-3 text-xs bg-white p-2 rounded border border-blue-100 shadow-sm">
                                üéØ Identifica√ß√£o & Inten√ß√£o
                            </div>
                        </div>
                    </div>

                    <div class="arrow-down md-arrow-hide">‚Üì</div>
                    <div class="arrow-right hidden md:block">‚Üí</div>

                    <!-- N1 Node -->
                    <div class="flex-1 flex flex-col items-center">
                        <div class="flow-box bg-teal-50 border-2 border-teal-200 p-6 rounded-xl text-center w-full h-full relative z-10">
                            <div class="text-4xl mb-2">‚öôÔ∏è</div>
                            <h3 class="font-bold text-teal-800 text-lg">N√≠vel 1 (N1)</h3>
                            <p class="text-sm font-semibold text-teal-600 mb-2">Autosservi√ßo Transacional</p>
                            <p class="text-xs text-slate-500">Einstein Bot + Flows</p>
                            <div class="mt-3 text-xs bg-white p-2 rounded border border-teal-100 shadow-sm">
                                ‚ö° Execu√ß√£o de Processos
                            </div>
                        </div>
                    </div>

                    <div class="arrow-down md-arrow-hide">‚Üì</div>
                    <div class="arrow-right hidden md:block">‚Üí</div>

                    <!-- N2 Node -->
                    <div class="flex-1 flex flex-col items-center">
                        <div class="flow-box bg-indigo-50 border-2 border-indigo-200 p-6 rounded-xl text-center w-full h-full relative z-10">
                            <div class="text-4xl mb-2">üéß</div>
                            <h3 class="font-bold text-indigo-800 text-lg">N√≠vel 2 (N2)</h3>
                            <p class="text-sm font-semibold text-indigo-600 mb-2">Resolu√ß√£o H√≠brida</p>
                            <p class="text-xs text-slate-500">Omni-Channel + Agentforce</p>
                            <div class="mt-3 text-xs bg-white p-2 rounded border border-indigo-100 shadow-sm">
                                üß† Humano ou IA Avan√ßada
                            </div>
                        </div>
                    </div>

                    <div class="arrow-down md-arrow-hide">‚Üì</div>
                    <div class="arrow-right hidden md:block">‚Üí</div>

                    <!-- N3 Node -->
                    <div class="flex-1 flex flex-col items-center">
                        <div class="flow-box bg-slate-100 border-2 border-slate-300 p-6 rounded-xl text-center w-full h-full relative z-10">
                            <div class="text-4xl mb-2">üõ°Ô∏è</div>
                            <h3 class="font-bold text-slate-800 text-lg">N√≠vel 3 (N3)</h3>
                            <p class="text-sm font-semibold text-slate-600 mb-2">Especialista / Backoffice</p>
                            <p class="text-xs text-slate-500">Slack Swarming + Case Mgt</p>
                            <div class="mt-3 text-xs bg-white p-2 rounded border border-slate-200 shadow-sm">
                                üîß Resolu√ß√£o Complexa
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- Section 2: KPIs and Benefits -->
        <section class="mb-20">
            <h2 class="text-3xl font-bold text-[#0f172a] mb-8 text-center">Impacto Estimado do Projeto</h2>
            <p class="text-center text-slate-600 max-w-2xl mx-auto mb-12">
                A implementa√ß√£o deste funil visa reduzir drasticamente o volume de chamados repetitivos e diminuir o tempo de resolu√ß√£o para o cliente.
            </p>

            <div class="grid grid-cols-1 md:grid-cols-2 gap-8">
                <!-- KPI 1: Deflection Rate -->
                <div class="bg-white p-6 rounded-xl shadow-lg border-l-8 border-[#0d9488]">
                    <h3 class="text-xl font-bold mb-2">Meta de Deflex√£o (N0 + N1)</h3>
                    <p class="text-sm text-slate-500 mb-6">Percentual de contatos retidos sem interven√ß√£o humana.</p>
                    <div class="chart-container">
                        <canvas id="deflectionChart"></canvas>
                    </div>
                    <div class="mt-4 text-center">
                        <p class="text-sm font-medium text-slate-600">
                            Estimativa de <span class="font-bold text-[#0d9488] text-lg">40% a 60%</span> de reten√ß√£o total.
                        </p>
                    </div>
                </div>

                <!-- KPI 2: AHT Reduction -->
                <div class="bg-white p-6 rounded-xl shadow-lg border-l-8 border-[#f97316]">
                    <h3 class="text-xl font-bold mb-2">Redu√ß√£o do TMA (Tempo M√©dio)</h3>
                    <p class="text-sm text-slate-500 mb-6">Economia de tempo no N2 devido ao contexto pr√©vio.</p>
                    <div class="chart-container">
                        <canvas id="ahtChart"></canvas>
                    </div>
                    <div class="mt-4 text-center">
                        <p class="text-sm font-medium text-slate-600">
                            O agente recebe o cliente j√° identificado, economizando de <span class="font-bold text-[#f97316] text-lg">30 a 60 segundos</span>.
                        </p>
                    </div>
                </div>
            </div>
        </section>

        <!-- Section 3: Deep Dive into Architecture Levels -->
        <section class="mb-20">
            <h2 class="text-3xl font-bold text-[#0f172a] mb-10 text-center">Detalhamento dos N√≠veis de Atendimento</h2>
            
            <div class="grid grid-cols-1 md:grid-cols-2 gap-8">
                
                <!-- N0 Details -->
                <div class="bg-white p-8 rounded-xl shadow-md">
                    <div class="flex items-center mb-4">
                        <span class="bg-blue-100 text-blue-800 text-xs font-semibold mr-2 px-2.5 py-0.5 rounded">N0</span>
                        <h3 class="text-xl font-bold text-gray-800">O Porteiro Inteligente</h3>
                    </div>
                    <p class="text-slate-600 mb-6 text-sm">
                        O N0 utiliza IA Generativa para responder d√∫vidas n√£o estruturadas e realizar a triagem. Ele identifica a "Macro Inten√ß√£o" do cliente consultando a Base de Conhecimento (FAQ) e o CRM.
                    </p>
                    <h4 class="font-bold text-sm text-slate-700 mb-3">Distribui√ß√£o T√≠pica de Inten√ß√µes (Exemplo)</h4>
                    <div class="chart-container" style="height: 250px;">
                        <canvas id="n0IntentChart"></canvas>
                    </div>
                    <ul class="mt-6 space-y-2 text-sm text-slate-600">
                        <li class="flex items-start"><span class="text-blue-500 mr-2">‚úì</span> Respostas via Grounding (sem alucina√ß√µes).</li>
                        <li class="flex items-start"><span class="text-blue-500 mr-2">‚úì</span> Handover inteligente para transacional.</li>
                    </ul>
                </div>

                <!-- N1 Details -->
                <div class="bg-white p-8 rounded-xl shadow-md">
                    <div class="flex items-center mb-4">
                        <span class="bg-teal-100 text-teal-800 text-xs font-semibold mr-2 px-2.5 py-0.5 rounded">N1</span>
                        <h3 class="text-xl font-bold text-gray-800">O Executor Transacional</h3>
                    </div>
                    <p class="text-slate-600 mb-6 text-sm">
                        Quando o cliente precisa de uma a√ß√£o (ex: 2¬™ via), o N0 transfere para o N1. O N1 √© um Einstein Bot estruturado focado em autosservi√ßo, que n√£o pergunta dados j√° informados.
                    </p>
                    <div class="bg-teal-50 border border-teal-100 rounded-lg p-4 mb-4">
                        <h4 class="font-bold text-teal-900 text-sm mb-2">Requisito Cr√≠tico: Jornada do Usu√°rio</h4>
                        <p class="text-xs text-teal-700">
                            Se o N1 falha, ele gera um log leg√≠vel ("Breadcrumbs") para o agente humano:
                            <br><br>
                            <code class="bg-white px-2 py-1 rounded border border-teal-200 block">User selected 'Invoice' > System Error 404 > User requested Agent</code>
                        </p>
                    </div>
                </div>

                <!-- N2 Details (Routing Logic) -->
                <div class="bg-white p-8 rounded-xl shadow-md md:col-span-2">
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-8 items-center">
                        <div>
                            <div class="flex items-center mb-4">
                                <span class="bg-indigo-100 text-indigo-800 text-xs font-semibold mr-2 px-2.5 py-0.5 rounded">N2</span>
                                <h3 class="text-xl font-bold text-gray-800">Roteamento Inteligente H√≠brido</h3>
                            </div>
                            <p class="text-slate-600 mb-6 text-sm">
                                O Omni-Channel decide o destino baseado na complexidade e valor do cliente. Casos de alto volume s√£o atendidos por IA especializada, enquanto casos sens√≠veis v√£o para humanos.
                            </p>
                            <ul class="space-y-3 text-sm text-slate-600">
                                <li class="flex items-start">
                                    <span class="text-indigo-500 font-bold mr-2">‚Üí</span>
                                    <span><strong>Cen√°rio A:</strong> Agente Inteligente para temas recorrentes e negocia√ß√µes padr√£o.</span>
                                </li>
                                <li class="flex items-start">
                                    <span class="text-indigo-500 font-bold mr-2">‚Üí</span>
                                    <span><strong>Cen√°rio B:</strong> Humano para reten√ß√£o cr√≠tica e suporte complexo.</span>
                                </li>
                                <li class="flex items-start">
                                    <span class="text-indigo-500 font-bold mr-2">‚Üí</span>
                                    <span><strong>Visibilidade:</strong> Agente recebe o "Context Card".</span>
                                </li>
                            </ul>
                        </div>
                        <div>
                            <h4 class="font-bold text-sm text-center text-slate-700 mb-3">L√≥gica de Distribui√ß√£o N2</h4>
                            <div class="chart-container">
                                <canvas id="routingChart"></canvas>
                            </div>
                        </div>
                    </div>
                </div>

            </div>
        </section>

        <!-- Technical Requirements Checklist -->
        <section class="bg-slate-800 text-white rounded-2xl p-8 mb-20 shadow-2xl">
            <h2 class="text-2xl font-bold mb-6 border-b border-slate-600 pb-2">Requisitos T√©cnicos Mandat√≥rios</h2>
            <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
                <!-- Req 1 -->
                <div class="bg-slate-700 p-5 rounded-lg">
                    <h3 class="font-bold text-[#38bdf8] mb-2">Gest√£o de Contexto</h3>
                    <p class="text-sm text-slate-300">
                        Implementa√ß√£o de objeto de sess√£o (<code>ContextObject</code>) carregando ContactID, Intent e SentimentScore entre N0, N1 e N2.
                    </p>
                </div>
                <!-- Req 2 -->
                <div class="bg-slate-700 p-5 rounded-lg">
                    <h3 class="font-bold text-[#38bdf8] mb-2">Skills-Based Routing</h3>
                    <p class="text-sm text-slate-300">
                        Omni-Channel configurado para ler vari√°veis de t√≥pico vindas do bot e rotear para filas espec√≠ficas (IA vs Humano).
                    </p>
                </div>
                <!-- Req 3 -->
                <div class="bg-slate-700 p-5 rounded-lg">
                    <h3 class="font-bold text-[#38bdf8] mb-2">Integra√ß√£o Slack (N3)</h3>
                    <p class="text-sm text-slate-300">
                        Service Cloud for Slack para "Swarming". Fechamento do caso no N3 deve notificar o propriet√°rio no N2.
                    </p>
                </div>
            </div>
        </section>

    </div>

    <!-- JavaScript Logic -->
    <script>
        // --- Utility Functions ---

        /**
         * Splits a long label string into an array of shorter strings for Chart.js
         * aimed at ~16 characters per line.
         */
        function processLabel(label) {
            const MAX_LENGTH = 16;
            if (label.length <= MAX_LENGTH) return label;

            const words = label.split(' ');
            const lines = [];
            let currentLine = words[0];

            for (let i = 1; i < words.length; i++) {
                if ((currentLine + " " + words[i]).length <= MAX_LENGTH) {
                    currentLine += " " + words[i];
                } else {
                    lines.push(currentLine);
                    currentLine = words[i];
                }
            }
            lines.push(currentLine);
            return lines;
        }

        // Common Tooltip Configuration (Mandatory from Prompt)
        const commonTooltipConfig = {
            callbacks: {
                title: function(tooltipItems) {
                    const item = tooltipItems[0];
                    let label = item.chart.data.labels[item.dataIndex];
                    if (Array.isArray(label)) {
                        return label.join(' ');
                    } else {
                        return label;
                    }
                }
            }
        };

        // --- Chart 1: Deflection Rate (Doughnut) ---
        const ctxDeflection = document.getElementById('deflectionChart').getContext('2d');
        const labelsDeflection = ['Reten√ß√£o Digital (N0/N1)', 'Transbordo Humano (N2)'];
        const processedLabelsDeflection = labelsDeflection.map(processLabel);

        new Chart(ctxDeflection, {
            type: 'doughnut',
            data: {
                labels: processedLabelsDeflection,
                datasets: [{
                    data: [60, 40],
                    backgroundColor: ['#0d9488', '#e2e8f0'], // Teal for success, Gray for remainder
                    hoverOffset: 4
                }]
            },
            options: {
                maintainAspectRatio: false,
                plugins: {
                    legend: { position: 'bottom' },
                    tooltip: commonTooltipConfig,
                    title: { display: false }
                }
            }
        });

        // --- Chart 2: AHT Reduction (Bar) ---
        const ctxAht = document.getElementById('ahtChart').getContext('2d');
        const labelsAht = ['TMA Atual (Sem Contexto)', 'TMA Projetado (Com Contexto)'];
        const processedLabelsAht = labelsAht.map(processLabel);

        new Chart(ctxAht, {
            type: 'bar',
            data: {
                labels: processedLabelsAht,
                datasets: [{
                    label: 'Segundos',
                    data: [300, 240], // 60s saving
                    backgroundColor: ['#94a3b8', '#f97316'], // Slate vs Orange (Highlight)
                    borderRadius: 5
                }]
            },
            options: {
                maintainAspectRatio: false,
                scales: {
                    y: { beginAtZero: true, title: { display: true, text: 'Segundos' } }
                },
                plugins: {
                    legend: { display: false },
                    tooltip: commonTooltipConfig
                }
            }
        });

        // --- Chart 3: N0 Intent Distribution (Horizontal Bar) ---
        const ctxN0 = document.getElementById('n0IntentChart').getContext('2d');
        const labelsN0 = ['D√∫vidas Simples (FAQ)', 'Status de Pedido', 'Solicita√ß√£o de Boleto', 'Problemas T√©cnicos', 'Outros Assuntos'];
        const processedLabelsN0 = labelsN0.map(processLabel);

        new Chart(ctxN0, {
            type: 'bar',
            data: {
                labels: processedLabelsN0,
                datasets: [{
                    label: '% do Volume',
                    data: [35, 25, 20, 15, 5],
                    backgroundColor: '#0284c7', // Primary Blue
                    borderRadius: 4
                }]
            },
            options: {
                indexAxis: 'y', // Horizontal bar
                maintainAspectRatio: false,
                scales: {
                    x: { beginAtZero: true, max: 50 }
                },
                plugins: {
                    legend: { display: false },
                    tooltip: commonTooltipConfig
                }
            }
        });

        // --- Chart 4: N2 Routing Logic (Pie) ---
        const ctxRouting = document.getElementById('routingChart').getContext('2d');
        const labelsRouting = ['Agente IA (Alto Volume)', 'Agente Humano (Complexo)'];
        const processedLabelsRouting = labelsRouting.map(processLabel);

        new Chart(ctxRouting, {
            type: 'pie',
            data: {
                labels: processedLabelsRouting,
                datasets: [{
                    data: [70, 30],
                    backgroundColor: ['#4f46e5', '#f43f5e'], // Indigo vs Rose
                    hoverOffset: 4
                }]
            },
            options: {
                maintainAspectRatio: false,
                plugins: {
                    legend: { position: 'right' },
                    tooltip: commonTooltipConfig
                }
            }
        });

    </script>
</body>
</html>