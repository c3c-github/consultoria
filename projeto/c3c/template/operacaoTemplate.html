<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Cockpit de Suporte - C3C Workplace</title>
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- √çcones Lucide -->
    <script src="https://unpkg.com/lucide@latest"></script>
    <!-- Fonte Montserrat -->
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">

    <script>
        tailwind.config = {
            theme: {
                extend: {
                    fontFamily: {
                        sans: ['Montserrat', 'sans-serif'],
                    },
                    colors: {
                        c3c: {
                            blue: '#2978FF',
                            teal: '#1DDDBD',
                            dark: '#1a1a1a',
                            bg: '#F8FAFC'
                        }
                    }
                }
            }
        }
    </script>

    <style>
        body { font-family: 'Montserrat', sans-serif; background-color: #F8FAFC; }
        .fade-in { animation: fadeIn 0.3s ease-out; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(5px); } to { opacity: 1; transform: translateY(0); } }
        
        .modal-backdrop { background-color: rgba(0, 0, 0, 0.5); backdrop-filter: blur(2px); }
        
        /* Anima√ß√£o do Cron√¥metro */
        .timer-pulse { animation: pulse-red 2s infinite; }
        @keyframes pulse-red {
            0% { box-shadow: 0 0 0 0 rgba(239, 68, 68, 0.7); }
            70% { box-shadow: 0 0 0 10px rgba(239, 68, 68, 0); }
            100% { box-shadow: 0 0 0 0 rgba(239, 68, 68, 0); }
        }
    </style>
</head>
<body class="h-screen flex overflow-hidden bg-c3c-bg">

    <!-- 1. SIDEBAR -->
    <aside class="w-20 lg:w-64 bg-white border-r border-gray-100 flex flex-col z-20 transition-all duration-300">
        <div class="h-20 flex items-center justify-center lg:justify-start lg:px-8 border-b border-gray-50">
            <div class="w-8 h-8 bg-gradient-to-br from-[#2978FF] to-[#1DDDBD] rounded-lg flex items-center justify-center text-white font-bold text-xs">C3C</div>
            <span class="hidden lg:block ml-3 font-bold text-gray-800 tracking-wide text-lg">Workplace</span>
        </div>
        <nav class="flex-1 py-6 space-y-2">
            <a href="#" class="flex items-center justify-center lg:justify-start gap-3 px-4 lg:px-6 py-3 text-gray-400 hover:bg-gray-50 transition-colors">
                <i data-lucide="layout-dashboard" class="w-5 h-5"></i>
                <span class="hidden lg:block font-medium text-sm">Vis√£o Geral</span>
            </a>
            <!-- Menu Ativo -->
            <a href="#" class="flex items-center justify-center lg:justify-start gap-3 px-4 lg:px-6 py-3 bg-indigo-50 text-indigo-600 border-r-4 border-indigo-500 font-semibold transition-colors">
                <i data-lucide="headset" class="w-5 h-5"></i>
                <span class="hidden lg:block text-sm">Mesa de Opera√ß√µes</span>
            </a>
            <a href="#" class="flex items-center justify-center lg:justify-start gap-3 px-4 lg:px-6 py-3 text-gray-400 hover:bg-gray-50 transition-colors">
                <i data-lucide="clock" class="w-5 h-5"></i>
                <span class="hidden lg:block font-medium text-sm">Minhas Horas</span>
            </a>
        </nav>
        
        <!-- Widget Status do Agente -->
        <div class="p-4 border-t border-gray-100 bg-gray-50">
            <div class="flex items-center justify-between mb-2">
                <span class="text-xs font-bold text-gray-500 uppercase">Meu Status</span>
                <span class="w-2 h-2 bg-green-500 rounded-full animate-pulse"></span>
            </div>
            <select class="w-full text-xs border-gray-300 rounded p-1 bg-white text-gray-700 font-bold focus:ring-0 cursor-pointer">
                <option value="available">üü¢ Dispon√≠vel</option>
                <option value="busy">üî¥ Em Atendimento</option>
                <option value="break">‚òï Pausa</option>
            </select>
        </div>
    </aside>

    <!-- 2. MAIN CONTENT -->
    <main class="flex-1 flex flex-col relative w-full overflow-hidden">
        
        <!-- Header: Filas e Aloca√ß√£o -->
        <header class="h-16 bg-white border-b border-gray-200 flex items-center justify-between px-6 shrink-0 shadow-sm z-10">
            <div class="flex items-center gap-4">
                <h1 class="text-lg font-bold text-gray-800 flex items-center gap-2">
                    <i data-lucide="layers" class="w-5 h-5 text-indigo-600"></i>
                    Minhas Filas
                </h1>
                <div class="h-6 w-px bg-gray-200"></div>
                
                <!-- Pills de Aloca√ß√£o -->
                <div class="flex gap-2">
                    <div class="flex items-center gap-2 px-3 py-1 bg-blue-50 border border-blue-100 rounded-full">
                        <span class="w-2 h-2 bg-blue-500 rounded-full"></span>
                        <span class="text-xs font-bold text-blue-700">Squad Salesforce (N2)</span>
                    </div>
                    <div class="flex items-center gap-2 px-3 py-1 bg-purple-50 border border-purple-100 rounded-full">
                        <span class="w-2 h-2 bg-purple-500 rounded-full"></span>
                        <span class="text-xs font-bold text-purple-700">Infraestrutura Geral</span>
                    </div>
                </div>
            </div>

            <div class="flex items-center gap-4">
                <div class="text-right">
                    <p class="text-[10px] text-gray-400 font-bold uppercase">Hoje</p>
                    <p class="text-sm font-bold text-gray-800">4h 15m trabalhadas</p>
                </div>
            </div>
        </header>

        <!-- Content Area: Split View -->
        <div class="flex-1 flex overflow-hidden">
            
            <!-- Coluna Esquerda: Lista de Chamados (60%) -->
            <div class="flex-1 overflow-y-auto p-6 border-r border-gray-200 bg-white">
                
                <div class="flex justify-between items-center mb-6">
                    <h2 class="text-lg font-bold text-gray-800">Fila de Atendimento</h2>
                    <div class="flex gap-2">
                        <input type="text" placeholder="Buscar ticket #ID..." class="bg-gray-50 border border-gray-200 rounded-lg px-3 py-1.5 text-sm focus:outline-none focus:ring-2 focus:ring-indigo-500">
                        <button class="p-2 bg-gray-100 rounded-lg hover:bg-gray-200"><i data-lucide="filter" class="w-4 h-4 text-gray-600"></i></button>
                    </div>
                </div>

                <!-- Lista de Tickets -->
                <div class="space-y-3">
                    
                    <!-- Ticket 1 (Cr√≠tico) -->
                    <div onclick="selectTicket(1)" class="ticket-card cursor-pointer bg-white border-l-4 border-l-red-500 border-y border-r border-gray-200 rounded-r-lg p-4 hover:shadow-md transition-all group active-ticket">
                        <div class="flex justify-between items-start mb-2">
                            <div class="flex items-center gap-2">
                                <span class="text-xs font-mono font-bold text-gray-500">#4502</span>
                                <span class="bg-red-100 text-red-700 text-[10px] font-bold px-2 py-0.5 rounded">Incidente Cr√≠tico</span>
                            </div>
                            <span class="text-[10px] font-bold text-red-500 flex items-center gap-1">
                                <i data-lucide="clock" class="w-3 h-3"></i> SLA: -2h (Vencido)
                            </span>
                        </div>
                        <h3 class="font-bold text-gray-800 mb-1 group-hover:text-indigo-600">Erro 500 no Checkout do E-commerce</h3>
                        <p class="text-xs text-gray-500 line-clamp-2">Cliente relata impossibilidade de fechar pedidos na loja VTEX. Logs indicam timeout na API de integra√ß√£o.</p>
                        <div class="mt-3 flex items-center gap-4 text-xs text-gray-400">
                            <span class="flex items-center gap-1"><i data-lucide="briefcase" class="w-3 h-3"></i> Cliente: Varejo Express</span>
                            <span class="flex items-center gap-1"><i data-lucide="calendar" class="w-3 h-3"></i> Aberto: Hoje 08:30</span>
                        </div>
                    </div>

                    <!-- Ticket 2 (Normal) -->
                    <div onclick="selectTicket(2)" class="ticket-card cursor-pointer bg-white border-l-4 border-l-yellow-400 border-y border-r border-gray-200 rounded-r-lg p-4 hover:shadow-md transition-all group">
                        <div class="flex justify-between items-start mb-2">
                            <div class="flex items-center gap-2">
                                <span class="text-xs font-mono font-bold text-gray-500">#4505</span>
                                <span class="bg-blue-100 text-blue-700 text-[10px] font-bold px-2 py-0.5 rounded">Solicita√ß√£o</span>
                            </div>
                            <span class="text-[10px] font-bold text-yellow-600 flex items-center gap-1">
                                <i data-lucide="clock" class="w-3 h-3"></i> SLA: 4h Restantes
                            </span>
                        </div>
                        <h3 class="font-bold text-gray-800 mb-1 group-hover:text-indigo-600">Cria√ß√£o de Usu√°rio no Salesforce</h3>
                        <p class="text-xs text-gray-500 line-clamp-2">Novo colaborador no setor comercial. Perfil: Sales Rep. Precisa de acesso ao Pipeline.</p>
                        <div class="mt-3 flex items-center gap-4 text-xs text-gray-400">
                            <span class="flex items-center gap-1"><i data-lucide="briefcase" class="w-3 h-3"></i> Cliente: Tech Solutions</span>
                            <span class="flex items-center gap-1"><i data-lucide="calendar" class="w-3 h-3"></i> Aberto: Hoje 10:15</span>
                        </div>
                    </div>

                    <!-- Ticket 3 (Baixa) -->
                    <div onclick="selectTicket(3)" class="ticket-card cursor-pointer bg-white border-l-4 border-l-green-500 border-y border-r border-gray-200 rounded-r-lg p-4 hover:shadow-md transition-all group">
                        <div class="flex justify-between items-start mb-2">
                            <div class="flex items-center gap-2">
                                <span class="text-xs font-mono font-bold text-gray-500">#4498</span>
                                <span class="bg-gray-100 text-gray-600 text-[10px] font-bold px-2 py-0.5 rounded">D√∫vida</span>
                            </div>
                            <span class="text-[10px] font-bold text-green-600 flex items-center gap-1">
                                <i data-lucide="clock" class="w-3 h-3"></i> SLA: 2 dias
                            </span>
                        </div>
                        <h3 class="font-bold text-gray-800 mb-1 group-hover:text-indigo-600">Como extrair relat√≥rio de leads?</h3>
                        <p class="text-xs text-gray-500 line-clamp-2">Usu√°rio com d√∫vida sobre os filtros do relat√≥rio mensal.</p>
                        <div class="mt-3 flex items-center gap-4 text-xs text-gray-400">
                            <span class="flex items-center gap-1"><i data-lucide="briefcase" class="w-3 h-3"></i> Cliente: Banco Alpha</span>
                            <span class="flex items-center gap-1"><i data-lucide="calendar" class="w-3 h-3"></i> Aberto: Ontem 16:00</span>
                        </div>
                    </div>

                </div>
            </div>

            <!-- Coluna Direita: Painel de A√ß√£o (40%) -->
            <div class="w-[400px] lg:w-[450px] bg-gray-50 flex flex-col border-l border-gray-200">
                
                <!-- CRON√îMETRO -->
                <div class="p-6 bg-white border-b border-gray-200 shadow-sm z-10">
                    <div class="flex justify-between items-center mb-4">
                        <span class="text-xs font-bold text-gray-400 uppercase tracking-wider">Cron√¥metro de Trabalho</span>
                        <div class="flex items-center gap-2">
                            <span class="w-2 h-2 bg-red-500 rounded-full animate-pulse hidden" id="recording-dot"></span>
                            <span class="text-xs font-bold text-red-500 hidden" id="recording-text">GRAVANDO</span>
                        </div>
                    </div>

                    <!-- Display do Tempo -->
                    <div class="text-center mb-6">
                        <div class="text-5xl font-mono font-bold text-gray-800 tracking-widest" id="timer-display">00:00:00</div>
                        <p class="text-xs text-gray-400 mt-2" id="timer-context">Selecione um chamado para iniciar</p>
                    </div>

                    <!-- Controles -->
                    <div class="flex gap-3 justify-center">
                        <button id="btn-start" onclick="startTimer()" class="w-14 h-14 bg-green-500 hover:bg-green-600 text-white rounded-full flex items-center justify-center shadow-lg transition-transform active:scale-95 disabled:opacity-50 disabled:cursor-not-allowed" disabled>
                            <i data-lucide="play" class="w-6 h-6 fill-current"></i>
                        </button>
                        <button id="btn-pause" onclick="pauseTimer()" class="w-14 h-14 bg-yellow-400 hover:bg-yellow-500 text-white rounded-full flex items-center justify-center shadow-lg transition-transform active:scale-95 hidden">
                            <i data-lucide="pause" class="w-6 h-6 fill-current"></i>
                        </button>
                        <button id="btn-stop" onclick="stopTimer()" class="w-14 h-14 bg-red-500 hover:bg-red-600 text-white rounded-full flex items-center justify-center shadow-lg transition-transform active:scale-95 hidden">
                            <i data-lucide="square" class="w-6 h-6 fill-current"></i>
                        </button>
                    </div>
                </div>

                <!-- Detalhes do Ticket Ativo -->
                <div class="flex-1 overflow-y-auto p-6" id="active-ticket-details">
                    <!-- Placeholder Inicial -->
                    <div class="h-full flex flex-col items-center justify-center text-gray-400 text-center opacity-60">
                        <i data-lucide="mouse-pointer-click" class="w-12 h-12 mb-3 text-gray-300"></i>
                        <p class="text-sm">Selecione um chamado na lista<br>para visualizar detalhes e apontar horas.</p>
                    </div>
                </div>

                <!-- Footer: Lan√ßamento Manual -->
                <div class="p-4 border-t border-gray-200 bg-white">
                    <button onclick="openManualModal()" class="w-full py-2 border border-gray-300 text-gray-600 rounded-lg text-sm font-bold hover:bg-gray-50 flex items-center justify-center gap-2">
                        <i data-lucide="edit-3" class="w-4 h-4"></i> Esqueci o timer (Lan√ßamento Manual)
                    </button>
                </div>
            </div>
        </div>
    </main>

    <!-- Modal de Confirma√ß√£o de Apontamento -->
    <div id="log-modal" class="fixed inset-0 modal-backdrop z-50 hidden flex items-center justify-center opacity-0 transition-opacity duration-300 p-4">
        <div class="bg-white rounded-xl shadow-2xl w-full max-w-md transform scale-95 transition-transform duration-300">
            <div class="p-5 border-b border-gray-100 flex justify-between items-center bg-indigo-50 rounded-t-xl">
                <h3 class="font-bold text-indigo-900 flex items-center gap-2">
                    <i data-lucide="save" class="w-4 h-4"></i> Registrar Atividade
                </h3>
            </div>
            <div class="p-6">
                <div class="mb-4">
                    <p class="text-xs text-gray-500 font-bold uppercase mb-1">Chamado</p>
                    <p class="font-bold text-gray-800 text-sm" id="modal-ticket-title">#4502 - Erro 500 no Checkout</p>
                </div>
                
                <div class="flex gap-4 mb-4">
                    <div class="flex-1">
                        <label class="block text-xs text-gray-500 font-bold mb-1">Tempo Decorrido</label>
                        <input type="text" id="modal-time" class="w-full border border-gray-300 rounded p-2 font-mono font-bold text-lg text-center bg-gray-50" readonly>
                    </div>
                    <div class="flex-1">
                        <label class="block text-xs text-gray-500 font-bold mb-1">Tipo</label>
                        <select class="w-full border border-gray-300 rounded p-2 text-sm bg-white">
                            <option>Trabalho Normal</option>
                            <option>Hora Extra</option>
                        </select>
                    </div>
                </div>

                <div class="mb-6">
                    <label class="block text-xs text-gray-500 font-bold mb-1">Coment√°rio T√©cnico (Opcional)</label>
                    <textarea class="w-full border border-gray-300 rounded p-2 text-sm h-20 resize-none focus:ring-2 focus:ring-indigo-500 outline-none" placeholder="O que foi feito?"></textarea>
                </div>

                <div class="flex justify-end gap-2">
                    <button onclick="closeLogModal()" class="px-4 py-2 text-gray-500 font-bold text-xs hover:bg-gray-100 rounded">Descartar</button>
                    <button onclick="confirmLog()" class="px-4 py-2 bg-indigo-600 text-white font-bold text-xs rounded hover:bg-indigo-700 shadow-md">Confirmar & Enviar para Folha</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Toast Notification -->
    <div id="toast" class="fixed bottom-5 right-5 bg-gray-900 text-white px-4 py-3 rounded-lg shadow-xl transform translate-y-20 opacity-0 transition-all duration-300 flex items-center gap-3 z-50">
        <i data-lucide="check-circle" class="w-5 h-5 text-green-400"></i>
        <div>
            <p class="text-sm font-bold">Apontamento Realizado!</p>
            <p class="text-xs text-gray-400">Sincronizado com Folha de Ponto.</p>
        </div>
    </div>

    <script>
        lucide.createIcons();

        // --- DADOS MOCK ---
        const tickets = {
            1: { id: '#4502', title: 'Erro 500 no Checkout', client: 'Varejo Express', sla: 'Vencido', desc: 'Cliente relata impossibilidade de fechar pedidos na loja VTEX. Logs indicam timeout.' },
            2: { id: '#4505', title: 'Cria√ß√£o de Usu√°rio', client: 'Tech Solutions', sla: '4h', desc: 'Novo colaborador no setor comercial.' },
            3: { id: '#4498', title: 'D√∫vida Relat√≥rio', client: 'Banco Alpha', sla: '2 dias', desc: 'Usu√°rio com d√∫vida sobre filtros.' }
        };

        let currentTicketId = null;
        let timerInterval = null;
        let seconds = 0;
        let isRunning = false;

        // --- L√ìGICA DE SELE√á√ÉO ---
        function selectTicket(id) {
            // Se timer estiver rodando em outro ticket, alertar (simplificado aqui)
            if (isRunning && currentTicketId !== id) {
                if(!confirm("Voc√™ tem um cron√¥metro rodando em outro chamado. Deseja parar e trocar?")) return;
                stopTimer();
            }

            currentTicketId = id;
            const t = tickets[id];

            // UI Highlight
            document.querySelectorAll('.ticket-card').forEach(el => el.classList.remove('border-l-indigo-600', 'bg-indigo-50'));
            // (Adicionar classe visual ao card clicado via JS seria aqui, mas vamos focar no painel)

            // Update Right Panel
            const panel = document.getElementById('active-ticket-details');
            panel.innerHTML = `
                <div class="fade-in">
                    <span class="inline-block bg-indigo-100 text-indigo-700 text-[10px] font-bold px-2 py-0.5 rounded mb-2">${t.client}</span>
                    <h2 class="text-xl font-bold text-gray-800 leading-tight mb-2">${t.title}</h2>
                    <p class="text-xs font-mono text-gray-500 mb-4">${t.id}</p>
                    
                    <div class="bg-white p-3 rounded border border-gray-200 mb-4">
                        <p class="text-xs font-bold text-gray-400 uppercase mb-1">Descri√ß√£o</p>
                        <p class="text-sm text-gray-600">${t.desc}</p>
                    </div>

                    <div class="space-y-2">
                        <p class="text-xs font-bold text-gray-400 uppercase">Hist√≥rico Recente</p>
                        <div class="text-xs text-gray-500 border-l-2 border-gray-200 pl-2">
                            <span class="font-bold">Ontem 14:00</span> - Analista N1 escalou para N2.
                        </div>
                        <div class="text-xs text-gray-500 border-l-2 border-gray-200 pl-2">
                            <span class="font-bold">Hoje 08:30</span> - Cliente enviou logs.
                        </div>
                    </div>
                </div>
            `;

            // Enable Start Button
            document.getElementById('btn-start').disabled = false;
            document.getElementById('timer-context').innerText = `Pronto para iniciar: ${t.id}`;
            document.getElementById('timer-context').className = "text-xs text-indigo-600 font-bold mt-2";
        }

        // --- L√ìGICA DO CRON√îMETRO ---
        function updateTimerDisplay() {
            const h = Math.floor(seconds / 3600).toString().padStart(2, '0');
            const m = Math.floor((seconds % 3600) / 60).toString().padStart(2, '0');
            const s = (seconds % 60).toString().padStart(2, '0');
            document.getElementById('timer-display').innerText = `${h}:${m}:${s}`;
        }

        function startTimer() {
            if (isRunning) return;
            isRunning = true;
            
            // UI Updates
            document.getElementById('btn-start').classList.add('hidden');
            document.getElementById('btn-pause').classList.remove('hidden');
            document.getElementById('btn-stop').classList.remove('hidden');
            
            document.getElementById('recording-dot').classList.remove('hidden');
            document.getElementById('recording-text').classList.remove('hidden');
            document.getElementById('timer-display').classList.add('text-red-500', 'timer-pulse');
            document.getElementById('timer-display').classList.remove('text-gray-800');

            timerInterval = setInterval(() => {
                seconds++;
                updateTimerDisplay();
            }, 1000);
        }

        function pauseTimer() {
            isRunning = false;
            clearInterval(timerInterval);
            
            // UI Updates
            document.getElementById('btn-start').classList.remove('hidden');
            document.getElementById('btn-pause').classList.add('hidden');
            document.getElementById('recording-dot').classList.add('hidden');
            document.getElementById('recording-text').classList.add('hidden');
            document.getElementById('timer-display').classList.remove('timer-pulse');
        }

        function stopTimer() {
            pauseTimer(); // Stop counting
            
            // Open Modal with Data
            const t = tickets[currentTicketId];
            document.getElementById('modal-ticket-title').innerText = `${t.id} - ${t.title}`;
            document.getElementById('modal-time').value = document.getElementById('timer-display').innerText;
            
            const modal = document.getElementById('log-modal');
            modal.classList.remove('hidden');
            setTimeout(() => {
                modal.classList.remove('opacity-0');
                modal.querySelector('div').classList.remove('scale-95');
            }, 10);
        }

        // --- L√ìGICA DE CONFIRMA√á√ÉO ---
        function confirmLog() {
            closeLogModal();
            
            // Reset Timer completely
            seconds = 0;
            updateTimerDisplay();
            document.getElementById('timer-display').classList.add('text-gray-800');
            document.getElementById('timer-display').classList.remove('text-red-500');
            document.getElementById('btn-stop').classList.add('hidden');
            document.getElementById('btn-start').disabled = true; // Force select again or keep same logic
            document.getElementById('btn-start').disabled = false; // Keep enabled for same ticket

            // Show Toast
            const toast = document.getElementById('toast');
            toast.classList.remove('translate-y-20', 'opacity-0');
            setTimeout(() => {
                toast.classList.add('translate-y-20', 'opacity-0');
            }, 3000);
        }

        function closeLogModal() {
            const modal = document.getElementById('log-modal');
            modal.classList.add('opacity-0');
            modal.querySelector('div').classList.add('scale-95');
            setTimeout(() => {
                modal.classList.add('hidden');
            }, 300);
        }

        function openManualModal() {
            // Reusing logic for demo, but usually opens empty modal
            if (!currentTicketId) { alert("Selecione um chamado primeiro."); return; }
            const t = tickets[currentTicketId];
            document.getElementById('modal-ticket-title').innerText = `${t.id} - ${t.title}`;
            document.getElementById('modal-time').value = "00:00:00"; // Manual entry
            document.getElementById('modal-time').readOnly = false; // Allow edit
            
            const modal = document.getElementById('log-modal');
            modal.classList.remove('hidden');
            setTimeout(() => {
                modal.classList.remove('opacity-0');
                modal.querySelector('div').classList.remove('scale-95');
            }, 10);
        }
    </script>
</body>
</html>